<!DOCTYPE html>
{% load i18n %}
{% load static %}
{% get_current_language as LANGUAGE_CODE %}
<html lang="{{ LANGUAGE_CODE }}">
<head>
  <meta charset="UTF-8" />
  <meta name="robots" content="noindex, nofollow">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <title>Astrometrika - Astrology Readings</title>
  <link rel="icon" href="{% static 'icons/favicon.png' %}" type="image/x-icon">

  <link rel="alternate" hreflang="en" href="https://www.astrometrika.com/en/" />
  <link rel="alternate" hreflang="ru" href="https://www.astrometrika.com/ru/" />
  <link rel="alternate" hreflang="sv" href="https://www.astrometrika.com/sv/" />

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Cinzel&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Playfair&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Quicksand&display=swap" rel="stylesheet">

  <!-- Styles -->
  <link rel="stylesheet" href="{% static 'styles.css' %}?v={{ timestamp }}">
</head>
<body>
  <header class="header">
    <div class="container">
      <a class="header-logo" href="/">
  <svg class="header-logo-svg" xmlns="http://www.w3.org/2000/svg" viewBox="100 170 420 420" preserveAspectRatio="xMidYMid meet">
    <style type="text/css">
      .st1{fill:#C0B28E;}
      .st2{fill:none;stroke:#C0B28E;stroke-width:4;stroke-miterlimit:10;}
    </style>
    <g>
      <polygon class="st1" points="305.9,236 410,483.1 409.4,428.9 305.9,187.6 202.3,428.9 201.7,483.1"/>
      <path class="st1" d="M305.9,397.1l103.5-69.5v154.5c0,2.2-0.7,4.4-2,6.3c-1.5,2.1-4,4.9-7.9,7.9h38.4c0,0-2.4-1.1-4.9-3.4
        c-3-2.8-4.7-6.8-4.7-11V293.6l-122.4,80l-122.4-80v188.3c0,4.1-1.6,8.2-4.7,11c-2.5,2.4-4.9,3.4-4.9,3.4h38.4
        c-4-3-6.5-5.8-7.9-7.9c-1.3-1.8-2-4-2-6.3V327.7L305.9,397.1z"/>
      <circle class="st2" cx="305.9" cy="375.7" r="203.5"/>
      <line class="st2" x1="404" y1="197.4" x2="207.2" y2="553.7"/>
      <line class="st2" x1="207.2" y1="197.4" x2="404" y2="553.7"/>
      <line class="st2" x1="172" y1="373.5" x2="101.9" y2="373.5"/>
      <line class="st2" x1="509.4" y1="373.5" x2="442.3" y2="373.5"/>
      <line class="st2" x1="453" y1="469.1" x2="477.5" y2="485"/>
      <line class="st2" x1="137" y1="264.1" x2="159.1" y2="278.5"/>
      <line class="st2" x1="159.6" y1="469.1" x2="134.4" y2="485.4"/>
      <line class="st2" x1="475.8" y1="263.8" x2="453" y2="278.6"/>
      <line class="st2" x1="305.9" y1="579.2" x2="305.9" y2="506.2"/>
    </g>
  </svg>
</a>

      <div class="header-actions">
        <form action="{% url 'set_language' %}" method="post" id="langForm">
              {% csrf_token %}
              <input name="next" type="hidden" value="/">
              <input type="hidden" name="language" id="languageInput" value="{{ LANGUAGE_CODE }}">
              <div class="custom-select">
                <div class="custom-select__selected" id="selectedLang">
                  {% if LANGUAGE_CODE == 'en' %}English{% elif LANGUAGE_CODE == 'ru' %}Русский{% else %}Svenska{% endif %}
                </div>
                <ul class="custom-select__options" id="langOptions">
                  <li data-value="en">English</li>
                  <li data-value="ru">Русский</li>
                  <li data-value="sv">Svenska</li>
                </ul>
              </div>
        </form>
        </div>

    </div>
  </header>

<main>
  <div class="container">
    <section class="hero">
      <div class="info">
        <h1 class="title">{% trans "Astrology Readings" %}</h1>
        <div class="intro">
          <h3 class="subtitle">{% trans "Gain Insight Into Your Life and Future" %}</h3>
          <p>{% trans "I offer personalized astrology readings to help you navigate life's challenges and opportunities. Discover your true potential and find guidance on your path." %}</p>
          <a href="#booking" class="button book-button">{% trans "Book a Reading" %}</a>
        </div>
      </div>
      <div class="image-container">
        <img src="{% static 'imgs/img.png' %}" alt="{% trans 'Astrologer portrait' %}" class="portrait" />
      </div>
    </section>

    <section id="booking" class="booking-section">
      <div class="container">
        <h2 class="booking-title">{% trans "Book a Reading" %}</h2>
        <p class="booking-subtitle">
          {% trans "Please fill out the form below to schedule your personalized astrology session. I will reach out to confirm the details." %}
        </p>
        <form class="booking-form" id="bookingForm">
          <label for="fullName">{% trans "Full Name" %}</label>
          <input type="text" id="fullName" name="fullName"  />

          <label for="email">{% trans "Email Address" %}</label>
          <input type="email" id="email" name="email"  />

          <div class="form-row">
            <div class="form-group">
              <label for="birthDate">{% trans "Date of Birth" %}</label>
              <input type="date" id="birthDate" name="birthDate"  />
            </div>
            <div class="form-group">
              <label for="birthTime">{% trans "Time of Birth" %}</label>
              <input type="time" id="birthTime" name="birthTime"  />
            </div>
            <div class="form-group location-input">
              <label for="birthPlace">{% trans "Place of Birth" %}</label>
              <div class="input-icon-wrapper">
                <input type="text" id="birthPlace" name="birthPlace" />
                <img src="{% static 'icons/location-icon.svg' %}" alt="Location icon" class="location-icon">
              </div>
            </div>
          </div>

          <label for="focusArea">{% trans "Focus Area (Optional)" %}</label>
          <textarea maxlength="1000" id="focusArea" name="focusArea" placeholder="{% trans 'e.g. love, career, spiritual growth...' %}"></textarea>
          <div id="charCount" style="font-size: 0.9em; color: #667; margin-top: 4px;">
            {% trans "0 / 1000 characters" %}
          </div>

          <button type="submit" class="button submit-button">{% trans "Submit Request" %}</button>
        </form>

        <div id="confirmationMessage" style="display: none; margin-top: 20px; color: white;">
          ✅ {% trans "Your request has been sent! I will contact you soon." %}
        </div>
            <div id="paymentOptions" style="display: none; margin-top: 30px; text-align: center;">
              <p style="margin-bottom: 16px;">{% trans "Thank you! Now you can proceed with the payment below:" %}</p>

              <a href="https://buy.stripe.com/dR6g1O9sh5wC2dO288" target="_blank" class="button pay-button stripe-button">
                <img src="{% static 'icons/stripe-logo.svg' %}" alt="Stripe logo" style="height: 20px; margin-right: 10px;" />
                {% trans "Pay via Stripe" %}
              </a>

              <a href="https://wise.com/pay/r/5xJ4nSIDUTfyR9E" target="_blank" class="button pay-button wise-button">
                <img src="{% static 'icons/wise-logo.png' %}" alt="Wise logo" style="height: 20px; margin-right: 10px;" />
                {% trans "Pay via Wise" %}
              </a>

              <!--<div style="margin-top: 30px;">-->
              <!--  <p style="margin-bottom: 12px;">{% trans "Scan QR to pay via Stripe" %}</p>-->
              <!--  <img src="{% static 'imgs/stripe-qr.png' %}" alt="Stripe QR Code" style="max-width: 180px; margin: 0 auto;" />-->
              <!--</div>-->
            </div>
      </div>
    </section>
  </div>
</main>


  <footer>

    <div class="footer-container">
      <nav class="footer-menu">

        <ul class="footer-menu-list">

        <li><a class="footer-menu-link" href="{% url 'privacy-policy' %}">{% trans "Privacy policy" %}</a></li>
        <li><a class="footer-menu-link" href="{% url 'terms-of-service' %}">{% trans "Terms of Service" %}</a></li>

        </ul>
      </nav>
      <p class="footer-copy">{% trans "Astrometrika. All rights reserved." %}</p>
    </div>
  </footer>
  <div class="stars"></div>

  <script src="{% static 'js/lang-select.js' %}?v={{ timestamp }}"></script>
  <script>
   // Booking form
  const bookingForm = document.getElementById('bookingForm');
  const confirmation = document.getElementById('confirmationMessage');

  bookingForm.addEventListener('submit', function (e) {
    e.preventDefault();

    const formData = {
      fullName: bookingForm.fullName.value,
      email: bookingForm.email.value,
      birthDate: bookingForm.birthDate.value,
      birthTime: bookingForm.birthTime.value,
      birthPlace: bookingForm.birthPlace.value,
      focusArea: bookingForm.focusArea.value
    };

    fetch("{% url 'send_booking_request' %}", {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-CSRFToken': getCookie('csrftoken'),
      },
      body: JSON.stringify(formData)
    })
    .then(response => {
      if (!response.ok) throw new Error('Network error');
      return response.json();
    })
    .then(data => {
      if (data.status === 'ok') {
        bookingForm.reset();
        confirmation.style.display = 'block';
       const paymentBlock = document.getElementById('paymentOptions');
        paymentBlock.style.display = 'block';
        setTimeout(() => {
          paymentBlock.classList.add('show');
        }, 10);

        // setTimeout(() => {
        //   confirmation.style.display = 'none';
        // }, 5000);
      } else {
        alert('Something went wrong. Try again.');
      }
    })
    .catch(error => {
      alert('An error occurred: ' + error.message);
    });
  });

  function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
      const cookies = document.cookie.split(';');
      for (let i = 0; i < cookies.length; i++) {
        const cookie = cookies[i].trim();
        if (cookie.substring(0, name.length + 1) === (name + '=')) {
          cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
          break;
        }
      }
    }
    return cookieValue;
  }

  // Character count
  const focusAreaInput = document.getElementById('focusArea');
  const charCountDisplay = document.getElementById('charCount');

  focusAreaInput.addEventListener('input', function () {
    const length = focusAreaInput.value.length;
    charCountDisplay.textContent = `${length} / 1000 characters`;
  });

  // Stars
  const starsContainer = document.querySelector('.stars');

  for (let i = 0; i < 100; i++) {
    const star = document.createElement('div');
    star.classList.add('star');

    const x = Math.random() * 100;
    const y = Math.random() * 100;
    const delay = Math.random() * 5;
    const duration = 1.5 + Math.random() * 3;

    star.style.left = `${x}vw`;
    star.style.top = `${y}vh`;
    star.style.animationDelay = `${delay}s`;
    star.style.animationDuration = `${duration}s`;

    starsContainer.appendChild(star);
  }

</script>
</body>
</html>