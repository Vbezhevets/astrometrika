<!DOCTYPE html>
{% load i18n %}
{% load static %}
{% get_current_language as LANGUAGE_CODE %}
<html lang="{{ LANGUAGE_CODE }}">
<head>
  <meta charset="UTF-8" />
  <meta name="robots" content="noindex, nofollow">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Astrometrika - Astrology Readings</title>
  <link rel="icon" href="{% static 'icons/favicon.png' %}" type="image/x-icon">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Cinzel&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Playfair&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Quicksand&display=swap" rel="stylesheet">

  <!-- Styles -->
  <link rel="stylesheet" href="{% static 'styles.css' %}?v={{ timestamp }}">
</head>
<body>
  <header class="header">
    <div class="container">
      <a class="header-logo" href="/">
        <img src="{% static 'imgs/header_logo.png' %}" alt="astro logo" class="header-logo-image" width="50" height="50" loading="lazy" />
      </a>
      <!--<nav class="header-menu">-->
      <!--  <ul class="header-menu-list">-->
      <!--    <li><a class="header-menu-link is-current" href="/">Home</a></li>-->
      <!--    <li><a class="header-menu-link" href="/">About</a></li>-->
      <!--    <li><a class="header-menu-link" href="/">Services</a></li>-->
      <!--  </ul>-->
      <!--</nav>-->
      <div class="header-actions">
        <a href="?lang={% if LANGUAGE_CODE == 'ru' %}en{% else %}ru{% endif %}" class="button lang-button">
            {% if LANGUAGE_CODE == 'ru' %}
              English
            {% else %}
              Русский
            {% endif %}
          </a>
      </div>
    </div>
  </header>

  <main>
    <div class="container">
      <section class="hero">
        <div class="info">
          <h1 class="title">Astrology<br>Readings</h2>
          <div class="intro">
            <h3 class="subtitle">Gain Insight Into Your Life and Future</h3>
            <p>I offer personalized astrology readings to help you navigate life's challenges and opportunities. Discover your true potential and find guidance on your path.</p>
            <a href="#booking" class="button book-button">Book a Reading</a>
          </div>
        </div>
        <div class="image-container">
            <img src="{% static 'imgs/img.png' %}" alt="Astrologer portrait" class="portrait" />
        </section>
      </div>
        <section id="booking" class="booking-section">
          <div class="container">
            <h2 class="booking-title">{% trans "Book a Reading" %}</h2>
            <p class="booking-subtitle">
              Please fill out the form below to schedule your personalized astrology session. I will reach out to confirm the details.
            </p>
            <form class="booking-form" id="bookingForm">
              <label for="fullName">Full Name</label>
              <input type="text" id="fullName" name="fullName" required />

                <!--<div class="form-group">-->
                  <label for="email">Email Address</label>
                  <input type="email" id="email" name="email" required />
                <!--</div>-->
              <div class="form-row">
                <div class="form-group">
                  <label for="birthDate">Date of Birth</label>
                  <input type="date" id="birthDate" name="birthDate" required />
                </div>
                <div class="form-group">
                  <label for="birthTime">Time of Birth</label>
                  <input type="time" id="" name="birthTime" required />
                </div>
                <div class="form-group">
                  <label for="birthPlace">Place of Birth</label>
                  <input type="" id="birthPlace" name="birthPlace" required />
                </div>
              </div>

        <label for="focusArea">Focus Area (Optional)</label>
        <textarea maxlength="1000" id="focusArea" name="focusArea" placeholder="e.g. love, career, spiritual growth..."></textarea>
        <div id="charCount" style="font-size: 0.9em; color: #667; margin-top: 4px;">
            0 / 1000 characters
        </div>

              <button type="submit" class="button submit-button">Submit Request</button>
            </form>

            <div id="confirmationMessage" style="display: none; margin-top: 20px; color: green;">
                ✅ Your request has been sent! I will contact you soon.
            </div>

          </div>
        </section>
      </div>
    </div>
    <div class="stars">
      <div class="star"></div>
      <div class="star"></div>
      <div class="star"></div>
    </div>
  </main>


  <footer>

    <div class="footer-container">
      <nav class="footer-menu">

        <ul class="footer-menu-list">
          <li><a class="footer-menu-link" href="/privacy-policy.html">Privacy policy</a></li>
          <li><a class="footer-menu-link" href="/">Terms of Service</a></li>
        </ul>
      </nav>
      <p class="footer-copy">Astro. All rights reserved.</p>
    </div>
  </footer>
  <script>
  const form = document.getElementById('bookingForm');
  const confirmation = document.getElementById('confirmationMessage');

  form.addEventListener('submit', function (e) {
    e.preventDefault();

    const formData = {
      fullName: form.fullName.value,
      email: form.email.value,
      birthDate: form.birthDate.value,
      birthTime: form.birthTime.value,
      birthPlace: form.birthPlace.value,
      focusArea: form.focusArea.value
    };

    fetch('/send_booking_request/', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-CSRFToken': getCookie('csrftoken'),
      },
      body: JSON.stringify(formData)
    })
    .then(response => {
      if (!response.ok) throw new Error('Network error');
      return response.json();
    })
    .then(data => {
      if (data.status === 'ok') {
        form.reset();
        confirmation.style.display = 'block';
        setTimeout(() => {
          confirmation.style.display = 'none';
        }, 5000);
      } else {
        alert('Something went wrong. Try again.');
      }
    })
    .catch(error => {
      alert('An error occurred: ' + error.message);
    });
  });

  // CSRF
  function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
      const cookies = document.cookie.split(';');
      for (let i = 0; i < cookies.length; i++) {
        const cookie = cookies[i].trim();
        // Does this cookie string begin with the name we want?
        if (cookie.substring(0, name.length + 1) === (name + '=')) {
          cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
          break;
        }
      }
    }
    return cookieValue;
  }

  const focusAreaInput = document.getElementById('focusArea');
const charCountDisplay = document.getElementById('charCount');

focusAreaInput.addEventListener('input', function () {
  const length = focusAreaInput.value.length;
  charCountDisplay.textContent = `${length} / 1000 characters`;
});


    const starsContainer = document.querySelector('.stars');

    for (let i = 0; i < 100; i++) {
      const star = document.createElement('div');
      star.classList.add('star');

      const x = Math.random() * 100;
      const y = Math.random() * 100;
      const delay = Math.random() * 5;
      const duration = 1.5 + Math.random() * 3;

      star.style.left = `${x}vw`;
      star.style.top = `${y}vh`;
      star.style.animationDelay = `${delay}s`;
      star.style.animationDuration = `${duration}s`;

      starsContainer.appendChild(star);
    }
  </script>
</body>
</html>